---
layout:     post
title:      IEC104开发教程
subtitle:   "\"IEC60870-5-104 Server \""
date:       2025-03-19
author:     Gavin
header-img: img/64ef35890cb90_computer_organization_and_architecture_01.png
catalog: true
tags:
- IEC104
---


# The Basics of IEC104 
`IEC 60870-5-104`远动规约用于厂站与调度主站间的通讯,电力系统中常见的设备分为:

- 调度端（<ins>主站、控制站、客户机</ins>）典型设备如SCADA
- 服务端（<ins>从站、子站、被控站、服务机</ins>）典型设备如FTU（馈线终端）、DTU（站所终端）、TTU（配变终端）、RTU（远程终端单元），两者之间通过104规约来进行数据通信与传输。

`IEC 60870-5-104`协议是基于`IEC 60870-5-101`协议在`TCP/IP`协议上使用的扩展。IEC 60870-5-101是基于串口的通信协议，IEC 60870-5-104是基于以太网的通信协议。默认端口是TCP2404。
- 参考资料

[Description and analysis of IEC 104 Protocol](https://www.fit.vut.cz/research/publication-file/c168651/279813/TR-IEC104.pdf).

## IEC 60870-5-104 TCP/IP模型
`IEC104`协议是基于TCP的应用层协议。其架构为client/Server 模式。 TCP Server 负责和实际的硬件控制，数据采集，命令执行等功能，因此也叫受控制站/分站， IEC101 中还被叫做Slave。TCP Client 负责远程控制，获取server采集的数据，配置server等，因此也叫控制站，IEC101 中还被叫做Master。

![mode](/img/iec104-101mode.png)

- Client (Master) :调度端（<ins>主站、控制站、客户机</ins>）
- Server (Slave)  :服务端（<ins>从站、子站、被控站、服务机</ins>）

![mode](/img/image.png)

## 传输模式
- 非平衡传输模式: 在该模式下，只有控制站（client）才能启动一次消息传输，受控站（server） 只能响应控制站（client）的请求。在这种模式下，控制站（client）通过依次轮询 所控制的 受控站（server）来获取对应的业务数据
    - SEND/NO REPLY – for global messages and for cyclic set-point commands
    - SEND/CONFIRM – for control commands and set-point commands
    - REQUEST/RESPOND – for polling data from the controlled outstations

- 平衡传输：在此模式下，每个站都可以发起消息传输。这些站可以同时充当控制站和受控站（称为组合站）。平衡传输仅限于点对点和多个点对点配置。支持的服务包括平衡传输：在此模式下，每个站都可以发起消息传输。这些站可以同时充当控制站和受控站（称为组合站）。平衡传输仅限于点对点和多个点对点配置。支持的服务包括
    - SEND/CONFIRM
    - SEND/NO REPLY – this can be initiated only by a controlling station with a broadcast address in a multiple point-to-point configuration